{% extends 'shared/base.html' %}
{% load jalali_tags %}

{% block refrence %}
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/blog-detail.css">
    <script src="/static/js/blog-detail.js"></script>
{% endblock %}

{% block title %}
    {{ object.title }}
{% endblock %}

{% block content %}

    <main>

        <div class="container ">

            <div class="content col-md-12">

                <div class="blog shadow border bg-white col-md-8">

                    <div class="blog-detail-header col-md-12">

                        <div class="blog-header-image col-md-12">
                            <img src="{{ object.image.url }}" class="col-md-12" alt="">
                        </div>

                        <div class="blog-header-title col-md-11">
                            <h1>{{ object.title }}</h1>
                        </div>

                        <div class="blog-header-info mt-4 col-md-11">

                            <div class="blog-header-date">
                                <p class="">{{ object.create_date.date|to_jalali }}</p>
                            </div>

                            <div class="blog-header-category">
                                <p class=""><a href="{% url 'blogs-page' %}?filter={{ object.category.first }}">{{ object.category.first }}</a></p>
                            </div>

                        </div>


                    </div>

                    <div class="blog-detail-body d-flex justify-content-center text-end mt-4 col-md-12">

                        <div class="blog-body-content col-md-10">

                            {{ object.text }}

                            <hr class="col-md-12 mt-5 mb-3">
                        </div>


                    </div>

                    <div class="blog-detail-footer d-flex justify-content-center col-md-12">

                        <div class="blog-footer-info col-md-10 mb-5">

                            <div class="blog-footer-l-side  col-md-5">

                                <div class="blog-short-link">

                                    <button class="btn" onclick="copyurl()">
                                        <i class="fa fa-copy"></i>
                                        <span class="blog-url">www.google.com</span>
                                    </button>

                                </div>

                                <div class="share-social col-md-5">

                                    <div class="social-item">
                                        <a href="#">
                                            <i class="fa-brands fa-telegram"></i>
                                        </a>
                                    </div>
                                    <div class="social-item">
                                        <a href="#">
                                            <i class="fa-brands fa-twitter"></i>
                                        </a>
                                    </div>
                                    <div class="social-item">
                                        <a href="#">
                                            <i class="fa-brands fa-instagram"></i>
                                        </a>
                                    </div>

                                </div>
                            </div>

                            <div class="blog-footer-r-side col-md-11">

                                <div class="blog-lac col-md-3">
{#                                    <button class="btn blog-like">#}
{#                                        <i class="fa fa-heart"></i>#}
{#                                        <span class="">0</span>#}
{#                                    </button>#}
                                    <button class="btn blog-comment">
                                        <i class="fa fa-comment"></i>
                                        <span class="comment-count">{{ all_comments.count }}</span>
                                    </button>
                                </div>

                            </div>


                        </div>

                    </div>


                </div>

                <div class="blog-detail-side border shadow bg-white col-md-3">

                    <div class="blog-detail-side-header mt-4">
                        <img src="{{ object.author.avatar.url }}" class="rounded-circle" alt="">
                        <div class="blog-detail-side-header-info text-center">
                            <h5 class="mt-3"><a href="{% url 'users_profile' object.author.username %}">{{ object.author.username }}</a></h5>
                            <p>{{ author.job_title }}</p>
                            <button class="btn btn-primary">دنبال کردن</button>
                        </div>
                    </div>

                    <hr class="col-md-10">

                    <div class="blog-tags col-md-10">

                    {% if object.tags %}

                        {% for tag in object.tags.all %}

                            <div class="tag-item">
                                <a href="#">
                                    <span>
                                        {{ tag }}
                                    </span>
                                </a>
                            </div>

                        {% endfor %}

                    {% endif %}

                    </div>


                </div>

            </div>

            <div class="blog-sac col-md-12">

                {% if similar_blogs %}
                    <div class="simillar-blogs col-md-8">

                        <h2>پست های مشابه <i class="fa-solid fa-circle"></i></h2>
                        <div class="blogs-list col-md-12">


                    {% for similar_blog in similar_blogs %}

                        <div class="blog-item border col-md-5 shadow">
                            <a href="{% url 'blog-detail-page' similar_blog.id %}"><img class="similar-blog-image" src="{{ similar_blog.image.url }}" alt=""></a>
                            <h5 class="mt-3"><a href="{% url 'blog-detail-page' similar_blog.id %}">{{ similar_blog.title }}</a></h5>
                            <div class="blog-item-footer col-md-12">
                                <div class="user">
                                    <a href="{% url 'users_profile' similar_blog.author.username %}">
                                        <img src="{{ similar_blog.author.avatar.url }}" alt="">
                                        <span>{{ similar_blog.author.get_full_name }}</span>
                                    </a>
                                </div>

                                <div class="tag">
                                    <a href="{% url 'blogs-page' %}?filter={{ similar_blog.category.first }}">
                                        <p>{{ similar_blog.category.first }}</p>
                                    </a>
                                </div>
                            </div>

                        </div>

                    {% endfor %}

                        </div>

                    </div>

                {% endif %}


                <div class="blog-comment col-md-8" id="type-comment">
                    <h2>نظرات <i class="fa fa-comment"></i></h2>

                    <div class="blog-comment-input border shadow col-md-12">
                        {% csrf_token %}
                        <input type="hidden" value="" id="parentid">
                        <textarea class="col-md-10 comment-textarea" placeholder="نظر خود را وارد کنید" name="" id="" cols="30"
                            rows="10"></textarea>
                        <button class="btn btn-primary col-md-2" onclick="sendcommect({{ object.id }})">ارسال</button>
                    </div>

                    <div class="blog-comment-items col-md-12">

                        {% for comment in comments %}

                            <div class="blog-comment-item border shadow">
                            <div class="comment-item-image">
                                <img src="{{ comment.author.avatar.url }}" alt="">
                            </div>

                            <div class="comment-item-body">

                                <div class="comment-header col-md-12">

                                    <h5><a href="">{{ comment.author.get_full_name }}</a></h5>
                                    <span class="tag-item">
                                        {{ comment.create_date.date|to_jalali }}
                                    </span>

                                </div>
                                <p class="comment-text">
                                    {{ comment.text }}
                                </p>
                                <div class="comment-item-footer d-flex justify-content-end">

                                    <button class="btn btn-outline-primary comment-item-reply" onclick="anwsercomment({{ comment.id }})">
                                            <i class="fa fa-reply"></i>
                                            <span>پاسخ</span>
                                    </button>

                                </div>
                            </div>

                        </div>

                            {% for sub_comment in comment.blog_comments_set.all %}

                                <div class="blog-comment-item sub-comment border col-md-11 shadow">
                                    <div class="comment-item-image">
                                        <img src="{{ sub_comment.author.avatar.url }}" alt="">
                                    </div>

                                    <div class="comment-item-body">

                                        <div class="comment-header col-md-12">

                                            <h5><a href="">{{ sub_comment.author.get_full_name }}</a></h5>
                                            <span class="tag-item">
                                                {{ sub_comment.create_date.date|to_jalali }}
                                            </span>

                                        </div>
                                        <p class="comment-text">
                                            {{ sub_comment.text }}
                                        </p>

                                    </div>


                                </div>

                            {% endfor %}



                        {% endfor %}

                    </div>

                </div>

            </div>

            <div class="alerts fixed-top col-md-12 d-flex justify-content-end">

                <div class="alert alert-success fade d-none" role="alert">
                </div>

                <div class="alert alert-danger fade d-none" role="alert">
                </div>

            </div>


        </div>



        </div>

    </main>

{% endblock %}

{% block footer-refrence %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
{% endblock %}

